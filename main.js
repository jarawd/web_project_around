!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var o=function(){return e=function e(t,r,o){var n=o.handleCardClick,i=o.handleCardClose,u=o.likes,a=o.dislikes,c=o.obj;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data=t,this._cardSelector=r,this._handleCardClick=n,this._handleCardClose=i,this._likes=u,this._dislikes=a,this._obj=c},(r=[{key:"_getTemplate",value:function(){return this._cardTemplate=document.querySelector(this._cardSelector).content.querySelector(".elements__card").cloneNode(!0),this._cardTemplate}},{key:"generateCard",value:function(){if(this._card=this._getTemplate(),this._card.querySelector(".elements__img").src=this._data.link,this._card.querySelector(".elements__img").alt=this._data.name,this._card.querySelector(".elements__title").textContent=this._data.name,this._card.querySelector(".elements__likes-counter").textContent=this._data.likes.length,"38cc323bf81d67435752af78"===this._data.owner._id){var e=document.createElement("div");e.classList.add("elements__trash"),this._card.insertAdjacentElement("afterbegin",e)}return this.setEventListeners(),this._fillLikeButton(),this._card}},{key:"getImage",value:function(){return this._card.querySelector(".elements__img")}},{key:"_fillLikeButton",value:function(){var e=this._obj.likes.some((function(e){return"38cc323bf81d67435752af78"===e._id}));this._obj.likes.length>0&&e?this._card.querySelector(".elements__like").classList.add("elements__like-fill"):this._card.querySelector(".elements__like").classList.remove("elements__like-fill")}},{key:"setEventListeners",value:function(){var e=this;this._card.querySelector(".elements__img").addEventListener("click",(function(){e._handleCardClick()})),this._card.querySelector(".elements__like").addEventListener("click",(function(){e._card.querySelector(".elements__like").classList.toggle("elements__like-fill"),e._card.querySelector(".elements__like").classList.contains("elements__like-fill")?e._likes(e._obj).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(t){e._card.querySelector(".elements__likes-counter").textContent=t.likes.length})).catch((function(e){console.log(e)})):e._dislikes(e._obj).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(t){e._card.querySelector(".elements__likes-counter").textContent=t.likes.length})).catch((function(e){console.log(e)}))})),"38cc323bf81d67435752af78"===this._data.owner._id&&this._card.querySelector(".elements__trash").addEventListener("click",(function(){e._handleCardClose()}))}}])&&t(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}();function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function u(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var a=function(){return e=function e(t,r){var o,n,i,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,i=function(){var e=Array.from(a._form.querySelectorAll(a._input));a._toggleButton(e),a._form.addEventListener("submit",(function(e){e.preventDefault()})),e.forEach((function(t){t.addEventListener("input",(function(){a._validityInput(t),a._toggleButton(e)}))}))},(n=u(n="enableValidation"))in o?Object.defineProperty(o,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[n]=i,this._inputErrorClass=t.inputErrorClass,this._submitButton=t.submitButtonSelector,this._inactiveButton=t.inactiveButtonClass,this._input=t.input,this._form=r},(t=[{key:"_showInputError",value:function(e,t){e.classList.add(this._inputErrorClass),this._form.querySelector(".".concat(e.id,"-error")).textContent=t}},{key:"_hideInputError",value:function(e){e.classList.remove(this._inputErrorClass),this._form.querySelector(".".concat(e.id,"-error")).textContent=""}},{key:"_validityInput",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_validityAllInputs",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_toggleButton",value:function(e){this._validityAllInputs(e)?(this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButton)):(this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButton))}}])&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,p(o.key),o)}}function p(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}var s=function(){return e=function e(t,r){var o=t.data,n=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=o,this._renderer=n,this._cardsContainer=r},(t=[{key:"addItem",value:function(e){this._cardsContainer.prepend(e)}},{key:"renderItems",value:function(){var e=this;this._items.reverse().forEach((function(t){e._renderer(t)}))}}])&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function y(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_(o.key),o)}}function _(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=f(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}var m=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupSelector=t},(t=[{key:"open",value:function(e){document.querySelector(".page").prepend(e)}},{key:"close",value:function(){this._popupSelector.remove()}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&(this.close(),document.removeEventListener("keydown",this._handleEscClose))}},{key:"setEventListeners",value:function(){var e=this;document.addEventListener("keydown",(function(t){e._handleEscClose(t)}))}}])&&y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function b(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,h(o.key),o)}}function h(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=d(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}function v(e,t,r){return t=w(t),function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,S()?Reflect.construct(t,r||[],w(e).constructor):t.apply(e,r))}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(S=function(){return!!e})()}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},g.apply(this,arguments)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}var k=function(e){function t(e,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=v(this,t,[e]))._popupSelector=e,o._target=r,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(t,e),r=t,(o=[{key:"open",value:function(){this._popupSelector.querySelector(".image-container__img").src=this._target.src,this._popupSelector.querySelector(".image-container__img").alt=this._target.alt,this._popupSelector.querySelector(".image-container__title").textContent=this._target.alt,this.setEventListeners(),g(w(t.prototype),"open",this).call(this,this._popupSelector)}},{key:"setEventListeners",value:function(){var e=this;this._popupSelector.querySelector(".image-container__close").addEventListener("click",(function(){g(w(t.prototype),"close",e).call(e)})),document.addEventListener("click",(function(r){r.target===e._popupSelector&&g(w(t.prototype),"close",e).call(e)})),g(w(t.prototype),"setEventListeners",this).call(this)}}])&&b(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(m);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function O(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,C(o.key),o)}}function C(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=E(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}function P(e,t,r){return t=T(t),function(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,q()?Reflect.construct(t,r||[],T(e).constructor):t.apply(e,r))}function q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(q=function(){return!!e})()}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},L.apply(this,arguments)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}var B=function(e){function t(e,r){var o,n=e.data,i=e.setData;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=P(this,t,[r]))._popupSelector=r,o._data=n,o._setData=i,o.buttonName=n.buttonName,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(t,e),r=t,(o=[{key:"open",value:function(){this._setForm(),this.setEventListeners(),L(T(t.prototype),"open",this).call(this,this._popupSelector)}},{key:"close",value:function(){this._resetForm(),L(T(t.prototype),"close",this).call(this)}},{key:"_setForm",value:function(){this._data.values&&(this._popupSelector.querySelector(".popup__form-item_name").value=this._setData().getUserInfo().name,this._popupSelector.querySelector(".popup__form-item_info").value=this._setData().getUserInfo().job),this._data.inputInfo&&(this._popupSelector.querySelector(".popup__form-item_info").setAttribute("minlength","2"),this._popupSelector.querySelector(".popup__form-item_info").setAttribute("maxlength","200")),this._popupSelector.querySelector(".popup__title").textContent=this._data.title,this._popupSelector.querySelector(".popup__form-item_name").placeholder=this._data.placeholder1,this._popupSelector.querySelector(".popup__form-item_info").placeholder=this._data.placeholder2,this._popupSelector.querySelector(".popup__form-item_info").type=this._data.type,this._popupSelector.querySelector(".popup__form-button").textContent=this.buttonName,this._popupSelector.querySelector(".popup__form-item_name").setAttribute("minlength","2"),this._popupSelector.querySelector(".popup__form-item_name").setAttribute("maxlength","40"),this._popupSelector.classList.add("popup__opened")}},{key:"_getInputValues",value:function(){return{name:this._popupSelector.querySelector(".popup__form-item_name").value,link:this._popupSelector.querySelector(".popup__form-item_info").value}}},{key:"_resetForm",value:function(){var e=this;this._popupSelector.querySelectorAll(".popup__span-error").forEach((function(e){e.textContent=""})),this._popupSelector.querySelectorAll(".popup__form-item").forEach((function(t){t.classList.remove("popup__form-item_invalid"),e._data.resetInputs&&(t.value="")}))}},{key:"setEventListeners",value:function(){var e=this;this._popupSelector.querySelector(".popup__form").addEventListener("submit",(function(){e._data.values?(e._setData().setUserInfo(),e.close()):e._setData(e._getInputValues()),e._resetForm()})),this._popupSelector.querySelector(".popup__close").addEventListener("click",(function(){e.close()})),document.addEventListener("click",(function(t){t.target===e._popupSelector&&e.close()})),L(T(t.prototype),"setEventListeners",this).call(this)}}])&&O(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(m);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function R(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,D(o.key),o)}}function D(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=x(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:t+""}var N=function(){return e=function e(t,r){var o=t.nameSelector,n=t.jobSelector,i=t.setUser;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameSelector=o,this._jobSelector=n,this._popupSelector=r,this._setUser=i},(t=[{key:"getUserInfo",value:function(){return{name:this._nameSelector.textContent,job:this._jobSelector.textContent}}},{key:"setUserInfo",value:function(){this._nameSelector.textContent=this._popupSelector.querySelector(".popup__form-item_name").value,this._jobSelector.textContent=this._popupSelector.querySelector(".popup__form-item_info").value,this._setUser(this._popupSelector)}}])&&R(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function U(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,z(o.key),o)}}function z(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=A(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==A(t)?t:t+""}function F(e,t,r){return t=J(t),function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,V()?Reflect.construct(t,r||[],J(e).constructor):t.apply(e,r))}function V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(V=function(){return!!e})()}function G(){return G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=J(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},G.apply(this,arguments)}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}var M=function(e){function t(e,r){var o,n=r.card,i=r.element,u=r.removeCard;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=F(this,t,[e]))._popupSelector=e,o._card=n,o._element=i._card,o._removeCard=u,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(t,e),r=t,(o=[{key:"open",value:function(){this._popupSelector.classList.add("popup__opened"),this._setEventListeners(),G(J(t.prototype),"open",this).call(this,this._popupSelector)}},{key:"_deleteCard",value:function(){var e=this;this._removeCard(this._card).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(){e._element.remove()})).catch((function(e){console.log(e)}))}},{key:"_setEventListeners",value:function(){var e=this;this._popupSelector.querySelector(".popup-confirm__button").addEventListener("click",(function(){e._deleteCard(),G(J(t.prototype),"close",e).call(e)})),this._popupSelector.querySelector(".popup-confirm__close").addEventListener("click",(function(){G(J(t.prototype),"close",e).call(e)})),G(J(t.prototype),"setEventListeners",this).call(this)}}])&&U(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(m);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,W(o.key),o)}}function W(e){var t=function(e,t){if("object"!=K(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=K(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==K(t)?t:t+""}function X(e,t,r){return t=$(t),function(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Y()?Reflect.construct(t,r||[],$(e).constructor):t.apply(e,r))}function Y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Y=function(){return!!e})()}function Z(){return Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$(e)););return e}(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}},Z.apply(this,arguments)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}function ee(e,t){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ee(e,t)}var te=function(e){function t(e,r){var o,n=r.modifyAvatar;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=X(this,t,[e]))._popupSelector=e,o._modifyAvatar=n,o.buttonName=o._popupSelector.querySelector(".popup-profile__button"),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}(t,e),r=t,(o=[{key:"open",value:function(){this._popupSelector.classList.add("popup__opened"),this._setEventListeners(),Z($(t.prototype),"open",this).call(this,this._popupSelector)}},{key:"close",value:function(){this._resetForm(),Z($(t.prototype),"close",this).call(this)}},{key:"_resetForm",value:function(){this._popupSelector.querySelector(".popup-profile__span-error").textContent="";var e=this._popupSelector.querySelector(".popup-profile__form-item");e.classList.remove("popup__form-item_invalid"),e.value="",this.buttonName.textContent="Guardar"}},{key:"_setEventListeners",value:function(){var e=this;this._popupSelector.querySelector(".popup-profile__close").addEventListener("click",(function(){e.close()})),this._popupSelector.querySelector(".popup-profile__button").addEventListener("click",(function(t){e._modifyAvatar()})),Z($(t.prototype),"setEventListeners",this).call(this)}}])&&Q(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o}(m);function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function oe(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,ne(o.key),o)}}function ne(e){var t=function(e,t){if("object"!=re(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=re(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==re(t)?t:t+""}var ie=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl="https://around.nomoreparties.co/v1/web_es_12"},(t=[{key:"setProfileInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a"}})}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a"}})}},{key:"getCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a","Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})})}},{key:"getAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a","Content-Type":"application/json"},body:JSON.stringify({avatar:e})})}},{key:"getLikes",value:function(e){return fetch("https://around.nomoreparties.co/v1/web_es_12/cards/likes/".concat(e._id),{method:"PUT",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a","Content-Type":"application/json"},body:JSON.stringify({likes:e.likes>0?e.likes.push({about:e.owner.about,avatar:e.owner.avatar,cohort:e.owner.cohort,name:e.owner.name,_id:e.owner._id}):{about:e.owner.about,avatar:e.owner.avatar,cohort:e.owner.cohort,name:e.owner.name,_id:e.owner._id}})})}},{key:"getDislikes",value:function(e){return fetch("https://around.nomoreparties.co/v1/web_es_12/cards/likes/".concat(e._id),{method:"DELETE",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a","Content-Type":"application/json"}})}},{key:"deleteCard",value:function(e){return fetch("https://around.nomoreparties.co/v1/web_es_12/cards/".concat(e._id),{method:"DELETE",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a","Content-Type":"application/json"}})}},{key:"setUser",value:function(e){return fetch("https://around.nomoreparties.co/v1/web_es_12/users/me",{method:"PATCH",headers:{authorization:"e42f8e22-9ca0-486e-b216-ea9a771afa3a","Content-Type":"application/json"},body:JSON.stringify({name:e.querySelector(".popup__form-item_name").value,about:e.querySelector(".popup__form-item_info").value})})}}])&&oe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),ue=document.querySelector(".page"),ae=document.getElementById("profile-image"),ce=ue.querySelector(".profile__edit"),le=ue.querySelector(".profile__title"),pe=ue.querySelector(".profile__hobby"),se=ue.querySelector(".profile__add"),fe=document.querySelector("#popup-template").content,ye=document.querySelector("#image-template").content,_e=document.querySelector("#popup-confirm-template").content,me=document.querySelector("#popup-profile-template").content,de=fe.querySelector(".popup").cloneNode(!0),be=fe.querySelector(".popup").cloneNode(!0),he=ye.querySelector(".image-popup").cloneNode(!0),ve=_e.querySelector(".popup-confirm").cloneNode(!0),Se=me.querySelector(".popup-profile").cloneNode(!0),ge=document.querySelector(".profile__image"),we=ue.querySelector(".elements"),je=new ie;je.setProfileInfo().then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(e){le.textContent=e.name,pe.textContent=e.about,ae.src=e.avatar})).catch((function(e){console.log(e)})),je.getInitialCards().then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(e){var t=new s({data:e,renderer:function(e){var r=new o(e,"#card-template",{handleCardClick:function(){new k(he,r.getImage()).open()},handleCardClose:function(){new M(ve,{card:e,element:r,removeCard:je.deleteCard}).open()},likes:je.getLikes,dislikes:je.getDislikes,obj:e}),n=r.generateCard();t.addItem(n)}},we);t.renderItems()})).catch((function(e){return console.log(e)})),ue.addEventListener("click",(function(e){if(e.target===ce&&(new B({data:{title:"Edit profile",placeholder1:"Name",placeholder2:"Hobby",type:"text",buttonName:"Save",values:!0,resetInputs:!1},setData:function(){return new N({nameSelector:le,jobSelector:pe,setUser:je.setUser},de)}},de).open(),new a({submitButtonSelector:de.querySelector(".popup__form-button"),inactiveButtonClass:"popup-btn-disabled",inputErrorClass:"popup__form-item_invalid",input:".popup__form-item"},de.querySelector(".popup__form")).enableValidation()),e.target===se){var t=new B({data:{title:"Nuevo Lugar",placeholder1:"TÃ­tulo",placeholder2:"Enlace de la imagen",type:"url",buttonName:"Crear",resetInputs:!0},setData:function(e){var r=new s({data:[e],renderer:function(e){Object.values(e).every((function(e){return 0!==e.length}))&&(t.buttonName="Guardando...",t.open(),je.getCard(e).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(e){var n=new o(e,"#card-template",{handleCardClick:function(){new k(he,n.getImage()).open()},handleCardClose:function(){new M(ve,{card:e,element:n,removeCard:je.deleteCard}).open()},likes:je.getLikes,dislikes:je.getDislikes,obj:e}),i=n.generateCard();r.addItem(i),t.close()})).catch((function(e){console.log(e)})))}},we);r.renderItems()}},be);t.open(),new a({submitButtonSelector:be.querySelector(".popup__form-button"),inactiveButtonClass:"popup-btn-disabled",inputErrorClass:"popup__form-item_invalid",input:".popup__form-item"},be.querySelector(".popup__form")).enableValidation()}if(e.target===ge){var r=new te(Se,{modifyAvatar:function(){var e=Se.querySelector(".popup-profile__form-item").value;r.buttonName.textContent="Guardando...",r.open(),je.getAvatar(e).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))})).then((function(e){ae.src=e.avatar,r.close()})).catch((function(e){console.log(e)}))}});r.open(),new a({submitButtonSelector:Se.querySelector(".popup-profile__button"),inactiveButtonClass:"popup-btn-disabled",inputErrorClass:"popup__form-item_invalid",input:".popup-profile__form-item"},Se.querySelector(".popup-profile__form")).enableValidation()}}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1osQ0FDRixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJvamVjdC8uL3NyYy9zY3JpcHRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdC8uL3NyYy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdC8uL3NyYy9zY3JpcHRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJvamVjdC8uL3NyYy9zY3JpcHRzL1BvcHVwLmpzIiwid2VicGFjazovL3Byb2plY3QvLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0Ly4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0Ly4vc3JjL3NjcmlwdHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJvamVjdC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0Ly4vc3JjL3NjcmlwdHMvUG9wdXBQcm9maWxlSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdC8uL3NyYy9zY3JpcHRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIHsgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVDYXJkQ2xvc2UsIGxpa2VzLCBkaXNsaWtlcywgb2JqIH1cclxuICApIHtcclxuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsb3NlID0gaGFuZGxlQ2FyZENsb3NlO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX2Rpc2xpa2VzID0gZGlzbGlrZXM7XHJcbiAgICB0aGlzLl9vYmogPSBvYmo7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2NhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZFRlbXBsYXRlO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2ltZ1wiKS5zcmMgPSB0aGlzLl9kYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2ltZ1wiKS5hbHQgPSB0aGlzLl9kYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19saWtlcy1jb3VudGVyXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fZGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICBpZiAodGhpcy5fZGF0YS5vd25lci5faWQgPT09IFwiMzhjYzMyM2JmODFkNjc0MzU3NTJhZjc4XCIpIHtcclxuICAgICAgY29uc3QgdHJhc2hJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgdHJhc2hJY29uLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50c19fdHJhc2hcIik7XHJcbiAgICAgIHRoaXMuX2NhcmQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYWZ0ZXJiZWdpblwiLCB0cmFzaEljb24pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZmlsbExpa2VCdXR0b24oKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW1hZ2UoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19pbWdcIik7XHJcbiAgfVxyXG5cclxuICBfZmlsbExpa2VCdXR0b24oKSB7XHJcbiAgICBjb25zdCBsaWtlT3duZXIgPSB0aGlzLl9vYmoubGlrZXMuc29tZSgoZWwpID0+IHtcclxuICAgICAgcmV0dXJuIGVsLl9pZCA9PT0gXCIzOGNjMzIzYmY4MWQ2NzQzNTc1MmFmNzhcIjtcclxuICAgIH0pO1xyXG4gICAgaWYgKHRoaXMuX29iai5saWtlcy5sZW5ndGggPiAwICYmIGxpa2VPd25lcikge1xyXG4gICAgICB0aGlzLl9jYXJkXHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2xpa2VcIilcclxuICAgICAgICAuY2xhc3NMaXN0LmFkZChcImVsZW1lbnRzX19saWtlLWZpbGxcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jYXJkXHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2xpa2VcIilcclxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImVsZW1lbnRzX19saWtlLWZpbGxcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19faW1nXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fbGlrZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jYXJkXHJcbiAgICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fbGlrZVwiKVxyXG4gICAgICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50c19fbGlrZS1maWxsXCIpO1xyXG4gICAgICAgIGNvbnN0IGxpa2VTdGF0dXMgPSB0aGlzLl9jYXJkXHJcbiAgICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fbGlrZVwiKVxyXG4gICAgICAgICAgLmNsYXNzTGlzdC5jb250YWlucyhcImVsZW1lbnRzX19saWtlLWZpbGxcIik7XHJcbiAgICAgICAgaWYgKGxpa2VTdGF0dXMpIHtcclxuICAgICAgICAgIHRoaXMuX2xpa2VzKHRoaXMuX29iailcclxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX19saWtlcy1jb3VudGVyXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgICAgICAgICAgIGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLl9kaXNsaWtlcyh0aGlzLl9vYmopXHJcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fbGlrZXMtY291bnRlclwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgICAgICAgICAgICBkYXRhLmxpa2VzLmxlbmd0aDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIGlmICh0aGlzLl9kYXRhLm93bmVyLl9pZCA9PT0gXCIzOGNjMzIzYmY4MWQ2NzQzNTc1MmFmNzhcIikge1xyXG4gICAgICB0aGlzLl9jYXJkXHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX3RyYXNoXCIpXHJcbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgZm9ybVNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBkYXRhLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IGRhdGEuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbiA9IGRhdGEuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0ID0gZGF0YS5pbnB1dDtcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtU2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dCkge1xyXG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfdmFsaWRpdHlJbnB1dChpbnB1dCkge1xyXG4gICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCwgaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3ZhbGlkaXR5QWxsSW5wdXRzKGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b24oaW5wdXRMaXN0KSB7XHJcbiAgICBpZiAoIXRoaXMuX3ZhbGlkaXR5QWxsSW5wdXRzKGlucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dCkpO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uKGlucHV0TGlzdCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl92YWxpZGl0eUlucHV0KGVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oaW5wdXRMaXN0KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgcmVuZGVyZXIgfSwgY2FyZHNDb250YWluZXIpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gZGF0YTtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jYXJkc0NvbnRhaW5lciA9IGNhcmRzQ29udGFpbmVyO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jYXJkc0NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICBjb25zdCBpbnZlcnRlZEFycmF5ID0gdGhpcy5faXRlbXMucmV2ZXJzZSgpO1xyXG4gICAgaW52ZXJ0ZWRBcnJheS5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihlbCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgb3BlbihlbGVtZW50KSB7XHJcbiAgICBjb25zdCBwYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wYWdlXCIpO1xyXG4gICAgcGFnZS5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGUpIHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UoZSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB0YXJnZXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XHJcbiAgICB0aGlzLl90YXJnZXQgPSB0YXJnZXQ7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLWNvbnRhaW5lcl9faW1nXCIpLnNyYyA9XHJcbiAgICAgIHRoaXMuX3RhcmdldC5zcmM7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtY29udGFpbmVyX19pbWdcIikuYWx0ID1cclxuICAgICAgdGhpcy5fdGFyZ2V0LmFsdDtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1jb250YWluZXJfX3RpdGxlXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fdGFyZ2V0LmFsdDtcclxuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHN1cGVyLm9wZW4odGhpcy5fcG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3JcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtY29udGFpbmVyX19jbG9zZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLl9wb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhLCBzZXREYXRhIH0sIHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvciA9IHBvcHVwU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX3NldERhdGEgPSBzZXREYXRhO1xyXG4gICAgdGhpcy5idXR0b25OYW1lID0gZGF0YS5idXR0b25OYW1lO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3NldEZvcm0oKTtcclxuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHN1cGVyLm9wZW4odGhpcy5fcG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3Jlc2V0Rm9ybSgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIF9zZXRGb3JtKCkge1xyXG4gICAgaWYgKHRoaXMuX2RhdGEudmFsdWVzKSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1pdGVtX25hbWVcIikudmFsdWUgPVxyXG4gICAgICAgIHRoaXMuX3NldERhdGEoKS5nZXRVc2VySW5mbygpLm5hbWU7XHJcblxyXG4gICAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0taXRlbV9pbmZvXCIpLnZhbHVlID1cclxuICAgICAgICB0aGlzLl9zZXREYXRhKCkuZ2V0VXNlckluZm8oKS5qb2I7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuX2RhdGEuaW5wdXRJbmZvKSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwU2VsZWN0b3JcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1pdGVtX2luZm9cIilcclxuICAgICAgICAuc2V0QXR0cmlidXRlKFwibWlubGVuZ3RoXCIsIFwiMlwiKTtcclxuICAgICAgdGhpcy5fcG9wdXBTZWxlY3RvclxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtLWl0ZW1faW5mb1wiKVxyXG4gICAgICAgIC5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIyMDBcIik7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX190aXRsZVwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2RhdGEudGl0bGU7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0taXRlbV9uYW1lXCIpLnBsYWNlaG9sZGVyID1cclxuICAgICAgdGhpcy5fZGF0YS5wbGFjZWhvbGRlcjE7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0taXRlbV9pbmZvXCIpLnBsYWNlaG9sZGVyID1cclxuICAgICAgdGhpcy5fZGF0YS5wbGFjZWhvbGRlcjI7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0taXRlbV9pbmZvXCIpLnR5cGUgPVxyXG4gICAgICB0aGlzLl9kYXRhLnR5cGU7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0tYnV0dG9uXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5idXR0b25OYW1lO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3JcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0taXRlbV9uYW1lXCIpXHJcbiAgICAgIC5zZXRBdHRyaWJ1dGUoXCJtaW5sZW5ndGhcIiwgXCIyXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvclxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1pdGVtX25hbWVcIilcclxuICAgICAgLnNldEF0dHJpYnV0ZShcIm1heGxlbmd0aFwiLCBcIjQwXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5jbGFzc0xpc3QuYWRkKFwicG9wdXBfX29wZW5lZFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1pdGVtX25hbWVcIikudmFsdWUsXHJcbiAgICAgIGxpbms6IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1pdGVtX2luZm9cIikudmFsdWUsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgX3Jlc2V0Rm9ybSgpIHtcclxuICAgIGNvbnN0IHNwYW5MaXN0ID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19zcGFuLWVycm9yXCIpO1xyXG4gICAgc3Bhbkxpc3QuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgZWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2Zvcm0taXRlbVwiKTtcclxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX2Zvcm0taXRlbV9pbnZhbGlkXCIpO1xyXG4gICAgICBpZiAodGhpcy5fZGF0YS5yZXNldElucHV0cykge1xyXG4gICAgICAgIGVsLnZhbHVlID0gXCJcIjtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3JcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIGlmICh0aGlzLl9kYXRhLnZhbHVlcykge1xyXG4gICAgICAgICAgdGhpcy5fc2V0RGF0YSgpLnNldFVzZXJJbmZvKCk7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX3NldERhdGEodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3Jlc2V0Rm9ybSgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuX3BvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIHNldFVzZXIgfSwgcG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZVNlbGVjdG9yID0gbmFtZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5fam9iU2VsZWN0b3IgPSBqb2JTZWxlY3RvcjtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc2V0VXNlciA9IHNldFVzZXI7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVTZWxlY3Rvci50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JTZWxlY3Rvci50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbygpIHtcclxuICAgIHRoaXMuX25hbWVTZWxlY3Rvci50ZXh0Q29udGVudCA9IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX2Zvcm0taXRlbV9uYW1lXCJcclxuICAgICkudmFsdWU7XHJcbiAgICB0aGlzLl9qb2JTZWxlY3Rvci50ZXh0Q29udGVudCA9IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX2Zvcm0taXRlbV9pbmZvXCJcclxuICAgICkudmFsdWU7XHJcbiAgICB0aGlzLl9zZXRVc2VyKHRoaXMuX3BvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7IGNhcmQsIGVsZW1lbnQsIHJlbW92ZUNhcmQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcclxuICAgIHRoaXMuX2NhcmQgPSBjYXJkO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IGVsZW1lbnQuX2NhcmQ7XHJcbiAgICB0aGlzLl9yZW1vdmVDYXJkID0gcmVtb3ZlQ2FyZDtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fb3BlbmVkXCIpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHN1cGVyLm9wZW4odGhpcy5fcG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX3JlbW92ZUNhcmQodGhpcy5fY2FyZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBTZWxlY3RvclxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1jb25maXJtX19idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3JcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtY29uZmlybV9fY2xvc2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFByb2ZpbGVJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7IG1vZGlmeUF2YXRhciB9KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fbW9kaWZ5QXZhdGFyID0gbW9kaWZ5QXZhdGFyO1xyXG4gICAgdGhpcy5idXR0b25OYW1lID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cC1wcm9maWxlX19idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fb3BlbmVkXCIpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHN1cGVyLm9wZW4odGhpcy5fcG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3Jlc2V0Rm9ybSgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIF9yZXNldEZvcm0oKSB7XHJcbiAgICBjb25zdCBzcGFuID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cC1wcm9maWxlX19zcGFuLWVycm9yXCJcclxuICAgICk7XHJcbiAgICBzcGFuLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGNvbnN0IGlucHV0ID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cC1wcm9maWxlX19mb3JtLWl0ZW1cIlxyXG4gICAgKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9fZm9ybS1pdGVtX2ludmFsaWRcIik7XHJcbiAgICBpbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgICB0aGlzLmJ1dHRvbk5hbWUudGV4dENvbnRlbnQgPSBcIkd1YXJkYXJcIjtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3JcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtcHJvZmlsZV9fY2xvc2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLXByb2ZpbGVfX2J1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fbW9kaWZ5QXZhdGFyKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYl9lc18xMlwiO1xyXG4gIH1cclxuXHJcbiAgc2V0UHJvZmlsZUluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiZTQyZjhlMjItOWNhMC00ODZlLWIyMTYtZWE5YTc3MWFmYTNhXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlNDJmOGUyMi05Y2EwLTQ4NmUtYjIxNi1lYTlhNzcxYWZhM2FcIixcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZChvYmopIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiZTQyZjhlMjItOWNhMC00ODZlLWIyMTYtZWE5YTc3MWFmYTNhXCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBvYmoubmFtZSxcclxuICAgICAgICBsaW5rOiBvYmoubGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEF2YXRhcih1cmwpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlNDJmOGUyMi05Y2EwLTQ4NmUtYjIxNi1lYTlhNzcxYWZhM2FcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogdXJsLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0TGlrZXMob2JqKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXHJcbiAgICAgIGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYl9lc18xMi9jYXJkcy9saWtlcy8ke29iai5faWR9YCxcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImU0MmY4ZTIyLTljYTAtNDg2ZS1iMjE2LWVhOWE3NzFhZmEzYVwiLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBsaWtlczpcclxuICAgICAgICAgICAgb2JqLmxpa2VzID4gMFxyXG4gICAgICAgICAgICAgID8gb2JqLmxpa2VzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICBhYm91dDogb2JqLm93bmVyLmFib3V0LFxyXG4gICAgICAgICAgICAgICAgICBhdmF0YXI6IG9iai5vd25lci5hdmF0YXIsXHJcbiAgICAgICAgICAgICAgICAgIGNvaG9ydDogb2JqLm93bmVyLmNvaG9ydCxcclxuICAgICAgICAgICAgICAgICAgbmFtZTogb2JqLm93bmVyLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIF9pZDogb2JqLm93bmVyLl9pZCxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgOiB7XHJcbiAgICAgICAgICAgICAgICAgIGFib3V0OiBvYmoub3duZXIuYWJvdXQsXHJcbiAgICAgICAgICAgICAgICAgIGF2YXRhcjogb2JqLm93bmVyLmF2YXRhcixcclxuICAgICAgICAgICAgICAgICAgY29ob3J0OiBvYmoub3duZXIuY29ob3J0LFxyXG4gICAgICAgICAgICAgICAgICBuYW1lOiBvYmoub3duZXIubmFtZSxcclxuICAgICAgICAgICAgICAgICAgX2lkOiBvYmoub3duZXIuX2lkLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICB9KSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldERpc2xpa2VzKG9iaikge1xyXG4gICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICBgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWJfZXNfMTIvY2FyZHMvbGlrZXMvJHtvYmouX2lkfWAsXHJcbiAgICAgIHtcclxuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlNDJmOGUyMi05Y2EwLTQ4NmUtYjIxNi1lYTlhNzcxYWZhM2FcIixcclxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKG9iaikge1xyXG4gICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICBgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWJfZXNfMTIvY2FyZHMvJHtvYmouX2lkfWAsXHJcbiAgICAgIHtcclxuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlNDJmOGUyMi05Y2EwLTQ4NmUtYjIxNi1lYTlhNzcxYWZhM2FcIixcclxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyKHNlbGVjdG9yKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViX2VzXzEyL3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiZTQyZjhlMjItOWNhMC00ODZlLWIyMTYtZWE5YTc3MWFmYTNhXCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBzZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtLWl0ZW1fbmFtZVwiKS52YWx1ZSxcclxuICAgICAgICBhYm91dDogc2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1pdGVtX2luZm9cIikudmFsdWUsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuL3NjcmlwdHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4vc2NyaXB0cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi9zY3JpcHRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vc2NyaXB0cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgXCIuL3N0eWxlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi9zY3JpcHRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBQcm9maWxlSW1hZ2UgZnJvbSBcIi4vc2NyaXB0cy9Qb3B1cFByb2ZpbGVJbWFnZS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuL3NjcmlwdHMvQXBpLmpzXCI7XHJcblxyXG4vKlxyXG5NeSB0b2tlbjogZTQyZjhlMjItOWNhMC00ODZlLWIyMTYtZWE5YTc3MWFmYTNhXHJcbkdyb3B1IElEOiB3ZWJfZXNfMTJcclxuKi9cclxuXHJcbi8qIE1haW4gY29udGFpbmVyICovXHJcbmNvbnN0IHBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBhZ2VcIik7XHJcblxyXG5jb25zdCBpbWFnZVByb2ZpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtaW1hZ2VcIik7XHJcbmNvbnN0IGFkZFByb2ZpbGUgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdFwiKTtcclxuY29uc3QgbmFtZVByb2ZpbGUgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IGhvYmJ5UHJvZmlsZSA9IHBhZ2UucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19ob2JieVwiKTtcclxuY29uc3QgYWRkSW1hZ2UgPSBwYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkXCIpO1xyXG5cclxuLyogVGVtcGxhdGVzICovXHJcbmNvbnN0IHBvcHVwVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLXRlbXBsYXRlXCIpLmNvbnRlbnQ7XHJcbmNvbnN0IGltZ1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS10ZW1wbGF0ZVwiKS5jb250ZW50O1xyXG5jb25zdCBwb3B1cENvbmZpcm1UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcG9wdXAtY29uZmlybS10ZW1wbGF0ZVwiXHJcbikuY29udGVudDtcclxuY29uc3QgYXZhdGFyVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3BvcHVwLXByb2ZpbGUtdGVtcGxhdGVcIlxyXG4pLmNvbnRlbnQ7XHJcblxyXG4vKiBDbG9uZXMgKi9cclxuY29uc3QgcG9wdXBQcm9maWxlID0gcG9wdXBUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwXCIpLmNsb25lTm9kZSh0cnVlKTtcclxuY29uc3QgcG9wdXBJbWFnZSA9IHBvcHVwVGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5wb3B1cFwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbmNvbnN0IGltZ1BvcHVwID0gaW1nVGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cFwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbmNvbnN0IHBvcHVwQ29uZmlybSA9IHBvcHVwQ29uZmlybVRlbXBsYXRlXHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtY29uZmlybVwiKVxyXG4gIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbmNvbnN0IHBvcHVwQXZhdGFyID0gYXZhdGFyVGVtcGxhdGVcclxuICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1wcm9maWxlXCIpXHJcbiAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbi8qIFByb2ZpbGUgSW1hZ2UgKi9cclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbmNvbnN0IGNhcmRzID0gcGFnZS5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzXCIpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSgpO1xyXG5cclxuYXBpXHJcbiAgLnNldFByb2ZpbGVJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH0pXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIG5hbWVQcm9maWxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgaG9iYnlQcm9maWxlLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgIGltYWdlUHJvZmlsZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH0pO1xyXG5cclxuLyogUmVuZGVyIENhcmRzICovXHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH0pXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGNvbnN0IHJlbmRlckNhcmRzID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBkYXRhLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGl0ZW0sIFwiI2NhcmQtdGVtcGxhdGVcIiwge1xyXG4gICAgICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBpbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWdQb3B1cCwgY2FyZC5nZXRJbWFnZSgpKTtcclxuICAgICAgICAgICAgICBpbWFnZS5vcGVuKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhhbmRsZUNhcmRDbG9zZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHJlbW92ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24ocG9wdXBDb25maXJtLCB7XHJcbiAgICAgICAgICAgICAgICBjYXJkOiBpdGVtLFxyXG4gICAgICAgICAgICAgICAgZWxlbWVudDogY2FyZCxcclxuICAgICAgICAgICAgICAgIHJlbW92ZUNhcmQ6IGFwaS5kZWxldGVDYXJkLFxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHJlbW92ZUNhcmRQb3B1cC5vcGVuKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpa2VzOiBhcGkuZ2V0TGlrZXMsXHJcbiAgICAgICAgICAgIGRpc2xpa2VzOiBhcGkuZ2V0RGlzbGlrZXMsXHJcbiAgICAgICAgICAgIG9iajogaXRlbSxcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGNvbnN0IGVsZW1lbnRDYXJkID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICAgICAgICAgIHJlbmRlckNhcmRzLmFkZEl0ZW0oZWxlbWVudENhcmQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRzXHJcbiAgICApO1xyXG5cclxuICAgIHJlbmRlckNhcmRzLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG4vKiBFdmVudCBMaXN0ZW5lcnMgKi9cclxuXHJcbnBhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgaWYgKGUudGFyZ2V0ID09PSBhZGRQcm9maWxlKSB7XHJcbiAgICBjb25zdCBwcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gICAgICB7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgdGl0bGU6IFwiRWRpdCBwcm9maWxlXCIsXHJcbiAgICAgICAgICBwbGFjZWhvbGRlcjE6IFwiTmFtZVwiLFxyXG4gICAgICAgICAgcGxhY2Vob2xkZXIyOiBcIkhvYmJ5XCIsXHJcbiAgICAgICAgICB0eXBlOiBcInRleHRcIixcclxuICAgICAgICAgIGJ1dHRvbk5hbWU6IFwiU2F2ZVwiLFxyXG4gICAgICAgICAgdmFsdWVzOiB0cnVlLFxyXG4gICAgICAgICAgcmVzZXRJbnB1dHM6IGZhbHNlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0RGF0YTogKCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgdXNlciA9IG5ldyBVc2VySW5mbyhcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIG5hbWVTZWxlY3RvcjogbmFtZVByb2ZpbGUsXHJcbiAgICAgICAgICAgICAgam9iU2VsZWN0b3I6IGhvYmJ5UHJvZmlsZSxcclxuICAgICAgICAgICAgICBzZXRVc2VyOiBhcGkuc2V0VXNlcixcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcG9wdXBQcm9maWxlXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIHJldHVybiB1c2VyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHBvcHVwUHJvZmlsZVxyXG4gICAgKTtcclxuXHJcbiAgICBwcm9maWxlRm9ybS5vcGVuKCk7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICAgICAge1xyXG4gICAgICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBwb3B1cFByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybS1idXR0b25cIiksXHJcbiAgICAgICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cC1idG4tZGlzYWJsZWRcIixcclxuICAgICAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2Zvcm0taXRlbV9pbnZhbGlkXCIsXHJcbiAgICAgICAgaW5wdXQ6IFwiLnBvcHVwX19mb3JtLWl0ZW1cIixcclxuICAgICAgfSxcclxuICAgICAgcG9wdXBQcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIilcclxuICAgICk7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGUudGFyZ2V0ID09PSBhZGRJbWFnZSkge1xyXG4gICAgY29uc3QgaW1hZ2VGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgICAgIHtcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICB0aXRsZTogXCJOdWV2byBMdWdhclwiLFxyXG4gICAgICAgICAgcGxhY2Vob2xkZXIxOiBcIlTDrXR1bG9cIixcclxuICAgICAgICAgIHBsYWNlaG9sZGVyMjogXCJFbmxhY2UgZGUgbGEgaW1hZ2VuXCIsXHJcbiAgICAgICAgICB0eXBlOiBcInVybFwiLFxyXG4gICAgICAgICAgYnV0dG9uTmFtZTogXCJDcmVhclwiLFxyXG4gICAgICAgICAgcmVzZXRJbnB1dHM6IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXREYXRhOiAob2JqKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBhZGRDYXJkID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBkYXRhOiBbb2JqXSxcclxuICAgICAgICAgICAgICByZW5kZXJlcjogKG9iaikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC52YWx1ZXMob2JqKS5ldmVyeSgoZWwpID0+IGVsLmxlbmd0aCAhPT0gMCkpIHtcclxuICAgICAgICAgICAgICAgICAgaW1hZ2VGb3JtLmJ1dHRvbk5hbWUgPSBcIkd1YXJkYW5kby4uLlwiO1xyXG4gICAgICAgICAgICAgICAgICBpbWFnZUZvcm0ub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0Q2FyZChvYmopXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nUG9wdXAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkLmdldEltYWdlKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlLm9wZW4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlQ2FyZENsb3NlOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVtb3ZlQ2FyZCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cENvbmZpcm0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmQ6IGRhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGNhcmQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNhcmQ6IGFwaS5kZWxldGVDYXJkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2FyZC5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpa2VzOiBhcGkuZ2V0TGlrZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2xpa2VzOiBhcGkuZ2V0RGlzbGlrZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iajogZGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudENhcmQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgYWRkQ2FyZC5hZGRJdGVtKGVsZW1lbnRDYXJkKTtcclxuICAgICAgICAgICAgICAgICAgICAgIGltYWdlRm9ybS5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY2FyZHNcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICBhZGRDYXJkLnJlbmRlckl0ZW1zKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgcG9wdXBJbWFnZVxyXG4gICAgKTtcclxuICAgIGltYWdlRm9ybS5vcGVuKCk7XHJcblxyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgICAgIHtcclxuICAgICAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogcG9wdXBJbWFnZS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtLWJ1dHRvblwiKSxcclxuICAgICAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwLWJ0bi1kaXNhYmxlZFwiLFxyXG4gICAgICAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9fZm9ybS1pdGVtX2ludmFsaWRcIixcclxuICAgICAgICBpbnB1dDogXCIucG9wdXBfX2Zvcm0taXRlbVwiLFxyXG4gICAgICB9LFxyXG4gICAgICBwb3B1cEltYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIilcclxuICAgICk7XHJcblxyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9XHJcblxyXG4gIGlmIChlLnRhcmdldCA9PT0gcHJvZmlsZUF2YXRhcikge1xyXG4gICAgY29uc3QgY2hhbmdlQXZhdGFyID0gbmV3IFBvcHVwUHJvZmlsZUltYWdlKHBvcHVwQXZhdGFyLCB7XHJcbiAgICAgIG1vZGlmeUF2YXRhcjogKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHBvcHVwQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICBcIi5wb3B1cC1wcm9maWxlX19mb3JtLWl0ZW1cIlxyXG4gICAgICAgICkudmFsdWU7XHJcbiAgICAgICAgY2hhbmdlQXZhdGFyLmJ1dHRvbk5hbWUudGV4dENvbnRlbnQgPSBcIkd1YXJkYW5kby4uLlwiO1xyXG4gICAgICAgIGNoYW5nZUF2YXRhci5vcGVuKCk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZ2V0QXZhdGFyKHVybClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBpbWFnZVByb2ZpbGUuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgICAgICAgIGNoYW5nZUF2YXRhci5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgY2hhbmdlQXZhdGFyLm9wZW4oKTtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gICAgICB7XHJcbiAgICAgICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IHBvcHVwQXZhdGFyLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICBcIi5wb3B1cC1wcm9maWxlX19idXR0b25cIlxyXG4gICAgICAgICksXHJcbiAgICAgICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cC1idG4tZGlzYWJsZWRcIixcclxuICAgICAgICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2Zvcm0taXRlbV9pbnZhbGlkXCIsXHJcbiAgICAgICAgaW5wdXQ6IFwiLnBvcHVwLXByb2ZpbGVfX2Zvcm0taXRlbVwiLFxyXG4gICAgICB9LFxyXG4gICAgICBwb3B1cEF2YXRhci5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLXByb2ZpbGVfX2Zvcm1cIilcclxuICAgICk7XHJcblxyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9XHJcbn0pO1xyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJfcmVmIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ2FyZENsb3NlIiwibGlrZXMiLCJkaXNsaWtlcyIsIm9iaiIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfZGF0YSIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUNhcmRDbG9zZSIsIl9saWtlcyIsIl9kaXNsaWtlcyIsIl9vYmoiLCJrZXkiLCJ2YWx1ZSIsIl9jYXJkVGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmQiLCJfZ2V0VGVtcGxhdGUiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsInRleHRDb250ZW50IiwibGVuZ3RoIiwib3duZXIiLCJfaWQiLCJ0cmFzaEljb24iLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfZmlsbExpa2VCdXR0b24iLCJsaWtlT3duZXIiLCJzb21lIiwiZWwiLCJyZW1vdmUiLCJfdGhpcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0b2dnbGUiLCJjb250YWlucyIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiY29uY2F0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiRm9ybVZhbGlkYXRvciIsImZvcm1TZWxlY3RvciIsImlucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsIl9mb3JtIiwicXVlcnlTZWxlY3RvckFsbCIsIl9pbnB1dCIsIl90b2dnbGVCdXR0b24iLCJlIiwicHJldmVudERlZmF1bHQiLCJmb3JFYWNoIiwiX3ZhbGlkaXR5SW5wdXQiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX3N1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0IiwiZXJyb3JNZXNzYWdlIiwiaWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpbnB1dEVsZW1lbnQiLCJfdmFsaWRpdHlBbGxJbnB1dHMiLCJkaXNhYmxlZCIsIlNlY3Rpb24iLCJjYXJkc0NvbnRhaW5lciIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NhcmRzQ29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZXZlcnNlIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwU2VsZWN0b3IiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJQb3B1cFdpdGhJbWFnZSIsIl9Qb3B1cCIsInRhcmdldCIsIl9jYWxsU3VwZXIiLCJfdGFyZ2V0IiwiX2luaGVyaXRzIiwiX2dldCIsIl9nZXRQcm90b3R5cGVPZiIsInByb3RvdHlwZSIsImNhbGwiLCJfdGhpczIiLCJQb3B1cFdpdGhGb3JtIiwic2V0RGF0YSIsIl9zZXREYXRhIiwiYnV0dG9uTmFtZSIsIl9zZXRGb3JtIiwiX3Jlc2V0Rm9ybSIsInZhbHVlcyIsImdldFVzZXJJbmZvIiwiam9iIiwiaW5wdXRJbmZvIiwic2V0QXR0cmlidXRlIiwidGl0bGUiLCJwbGFjZWhvbGRlciIsInBsYWNlaG9sZGVyMSIsInBsYWNlaG9sZGVyMiIsInR5cGUiLCJyZXNldElucHV0cyIsIl90aGlzMyIsInNldFVzZXJJbmZvIiwiX2dldElucHV0VmFsdWVzIiwiVXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsInNldFVzZXIiLCJfbmFtZVNlbGVjdG9yIiwiX2pvYlNlbGVjdG9yIiwiX3NldFVzZXIiLCJQb3B1cFdpdGhDb25maXJtYXRpb24iLCJjYXJkIiwicmVtb3ZlQ2FyZCIsIl9lbGVtZW50IiwiX3JlbW92ZUNhcmQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZGVsZXRlQ2FyZCIsIlBvcHVwUHJvZmlsZUltYWdlIiwibW9kaWZ5QXZhdGFyIiwiX21vZGlmeUF2YXRhciIsIkFwaSIsIl9iYXNlVXJsIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidXJsIiwiYXZhdGFyIiwicHVzaCIsImFib3V0IiwiY29ob3J0Iiwic2VsZWN0b3IiLCJwYWdlIiwiaW1hZ2VQcm9maWxlIiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRQcm9maWxlIiwibmFtZVByb2ZpbGUiLCJob2JieVByb2ZpbGUiLCJhZGRJbWFnZSIsInBvcHVwVGVtcGxhdGUiLCJpbWdUZW1wbGF0ZSIsInBvcHVwQ29uZmlybVRlbXBsYXRlIiwiYXZhdGFyVGVtcGxhdGUiLCJwb3B1cFByb2ZpbGUiLCJwb3B1cEltYWdlIiwiaW1nUG9wdXAiLCJwb3B1cENvbmZpcm0iLCJwb3B1cEF2YXRhciIsInByb2ZpbGVBdmF0YXIiLCJjYXJkcyIsImFwaSIsInNldFByb2ZpbGVJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwicmVuZGVyQ2FyZHMiLCJpdGVtIiwiZ2V0SW1hZ2UiLCJvcGVuIiwiZGVsZXRlQ2FyZCIsImdldExpa2VzIiwiZ2V0RGlzbGlrZXMiLCJlbGVtZW50Q2FyZCIsImdlbmVyYXRlQ2FyZCIsImFkZEl0ZW0iLCJyZW5kZXJJdGVtcyIsImVuYWJsZVZhbGlkYXRpb24iLCJpbWFnZUZvcm0iLCJhZGRDYXJkIiwiT2JqZWN0IiwiZXZlcnkiLCJnZXRDYXJkIiwiY2hhbmdlQXZhdGFyIiwiZ2V0QXZhdGFyIl0sInNvdXJjZVJvb3QiOiIifQ==